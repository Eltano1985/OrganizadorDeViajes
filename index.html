<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planificador de Viajes</title>
    <link rel="stylesheet" href="estilos.css"> <!-- Enlace a tu archivo CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" /> <!-- CSS de Leaflet -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js"></script> <!-- QRCode.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/assets/owl.carousel.css"> <!-- CSS de Owl Carousel -->
</head>
<body>
    <header>
        <h1>Planificador de Viajes</h1>
    </header>
    <main>
        <div id="trip-planner">
            <div id="trip-form">
                <h2>Formulario de Planificación</h2>
                <form id="itinerary-form">
                    <div>
                        <label for="destination">Destino</label>
                        <input type="text" id="destination" name="destination" required>
                    </div>
                    <div>
                        <label for="start-date">Fecha de Salida</label>
                        <input type="date" id="start-date" name="start-date" required>
                    </div>
                    <div>
                        <label for="end-date">Fecha de Llegada</label>
                        <input type="date" id="end-date" name="end-date" required>
                    </div>
                    <button id="plan-trip-btn" type="submit" disabled>Planificar Viaje</button>
                </form>
                <div id="itinerary-list"></div> <!-- Lista de itinerarios -->
            </div>

            <div id="activities-section">
                <h2>Actividades sugeridas</h2>
                <div id="selection-error" style="display: none; color: red;">Has alcanzado el límite de 10 actividades.</div>
                <div id="image-carousel" class="owl-carousel"></div> <!-- Carrusel de imágenes -->
            </div>

            <div id="map-section">
                <h2>Mapa</h2>
                <div id="map" style="height: 400px;"></div> <!-- Establecer altura para el mapa -->
            </div>
        </div>
    </main>
    <footer>
        <p>© 2024 Planificador de Viajes</p>
        <div id="qr-code"></div> <!-- Contenedor para el QR Code -->
    </footer>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script> <!-- JS de Leaflet -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.carousel.min.js"></script> <!-- JS de Owl Carousel -->
    <script type="module" src="OrganizadorDeViajes.js"></script> <!-- Enlace a tu archivo JavaScript -->
    <script>
        // Generar el código QR cuando se carga la página
        $(document).ready(function() {
            const appUrl = "https://eltano1985.github.io/OrganizadorDeViajes/"; // Cambia esta URL a la dirección de tu aplicación
            $("#qr-code").qrcode({
                text: appUrl,
                width: 128, // Ancho del código QR
                height: 128 // Alto del código QR
            });

            // Inicializar el carrusel
            $("#image-carousel").owlCarousel({
                items: 3,
                loop: true,
                margin: 10,
                nav: true,
                dots: true
            });

            // Cargar imágenes de Pexels al enviar el formulario
            $("#itinerary-form").on("submit", function(e) {
                e.preventDefault();
                const destination = $("#destination").val();
                const apiKey = 'JYsFV9lbfdIrA9TYZ0QfFc6d61DFbbQub8lLLrplXYuIADPBYDp6XnC1'; // Reemplaza con tu API Key de Pexels
                const apiUrl = `https://api.pexels.com/v1/search?query=${destination}&per_page=10`;

                // Realizar la llamada a la API de Pexels
                $.ajax({
                    url: apiUrl,
                    method: 'GET',
                    headers: {
                        Authorization: apiKey
                    },
                    success: function(data) {
                        $("#image-carousel").empty(); // Limpiar el carrusel
                        data.photos.forEach(photo => {
                            $("#image-carousel").append(`
                                <div class="item">
                                    <img src="${photo.src.medium}" alt="${photo.alt}" />
                                    <label>
                                        <input type="checkbox" class="activity-checkbox" value="${photo.src.medium}" />
                                        Seleccionar
                                    </label>
                                </div>
                            `);
                        });
                        $("#image-carousel").owlCarousel('refresh'); // Actualizar el carrusel
                    }
                });

                // Activar el botón de planificar viaje
                $("#plan-trip-btn").prop("disabled", false);
            });
        });
    </script>
</body>
</html>
